import{I as e,r as t,d as a,g as l,o as n,R as o,w as s,a as i,u as r,a5 as u,a6 as c,L as d,_ as m,a7 as p,m as f,y as g,c as h}from"./index.dd3a459e.js";import{_ as y}from"./Pagination.876e8d2c.js";import{_ as w,a as v}from"./FormItem.bbd1df9d.js";import{_}from"./DataTable.285ee778.js";import{N as k}from"./Switch.06d86fc2.js";import"./use-locale.b971594d.js";import"./Popover.86cf4588.js";import"./next-frame-once.e5ee25e8.js";import"./Input.7c0904de.js";import"./Dropdown.15a8db93.js";import"./Tooltip.adf0c95b.js";function b(e=!1){const a=t(e);function l(e){a.value=e}return{bool:a,setBool:l,setTrue:function(){l(!0)},setFalse:function(){l(!1)},toggle:function(){l(!a.value)}}}const S=a({__name:"selectInput",props:{value:null,options:null,loading:{type:Boolean},label:null,isSlot:{type:Boolean,default:!0},clear:{type:Boolean,default:!0}},emits:["checkValue","searchValue","clearOption"],setup(e,{emit:t}){const a=e,p=l({get:()=>a.value,set:e=>t("checkValue",e)}),f=e=>t("searchValue",e);return(a,l)=>{const g=m,h=y,v=w;return n(),o(v,{label:e.label,path:"siteName"},{default:s((()=>[i(h,{value:r(p),"onUpdate:value":l[1]||(l[1]=e=>u(p)?p.value=e:null),filterable:"",options:e.options,loading:e.loading,clearable:"",remote:"",onSearch:f,onBlur:l[2]||(l[2]=a=>{e.clear&&t("clearOption")})},c({_:2},[e.isSlot?{name:"action",fn:s((()=>[i(g,{onClick:l[0]||(l[0]=t=>a.$emit("checkValue",e.value))},{default:s((()=>[d("添加新网站")])),_:1})])),key:"0"}:void 0]),1032,["value","options","loading"])])),_:1},8,["label"])}}}),j=a({__name:"websiteForm",setup(a){const{bool:l,toggle:u}=b(!1),c=t(""),{arr:d,setValue:m,clear:f}=function(e){const a=Array.isArray(e)&&e.length>0?t(e):t([]);function l(){a.value.length=0}return{arr:a,setValue:function(e){l(),Array.isArray(e)?a.value=e:a.value.push(e)},clear:l}}(),g=e=>{f(),c.value=e},h=p((async t=>{u();const a=await async function(t){return e.get(`/site/find/name?name=${t}`)}(t);u(),a&&(f(),a.forEach((e=>{d.value.push({label:e.name,value:e._id})})))}),1e3),y=e=>{e?h(e):f()};return(e,t)=>{const a=v;return n(),o(a,{"label-width":"auto"},{default:s((()=>[i(S,{options:r(d),value:r(c),loading:r(l),label:"网站名称：","is-slot":"",clear:"",onSearchValue:y,onCheckValue:g,onClearOption:t[0]||(t[0]=e=>r(f)()),onSlotClick:r(m)},null,8,["options","value","loading","onSlotClick"])])),_:1})}}}),V=a({__name:"DataTable",props:{data:null,columns:null,loading:{type:Boolean}},setup:e=>(t,a)=>{const l=_;return n(),o(l,{loading:e.loading,columns:e.columns,data:e.data,"single-line":!1},null,8,["loading","columns","data"])}}),B=a({__name:"contentSelector",setup(a){const{bool:l,setFalse:s}=b(!0),i=[{title:"网站名称",key:"name",width:130,rowSpan:e=>e.row},{title:"标题选择器",key:"title"},{title:"时间选择器",key:"time"},{title:"内容选择器",key:"content"},{title:"编辑",key:"crawler",width:100,render:e=>g(m,{value:e.state,size:"small",loading:e.loading,onClick:()=>123},(()=>"编辑"))}],u=t([]);return f((async()=>{const t=await async function(){return e.get("/site/get/selector")}();t&&(t.forEach((e=>{const t=e.list;t&&t.length>0&&t.forEach((a=>{u.value.push({key:a._id,name:e.name,title:a.title,time:a.time,content:a.content,row:t.length})}))})),s())})),(e,t)=>{const a=V;return n(),o(a,{loading:r(l),columns:i,data:r(u)},null,8,["loading","data"])}}}),C=a({__name:"SiteInfo",setup(a){const{bool:l,setFalse:s}=b(!0),i=async t=>{const a=t.state?0:1,l=await async function(t,a){return e.get(`/crawler/switch/link?_id=${t}&state=${a}`)}(t.key,a);t.loading=!0,l&&(t.state=!t.state),t.loading=!1},u=[{title:"网站名称",key:"name",width:130,rowSpan:e=>e.row},{title:"默认链接选择器",key:"defaultSelector",width:160,ellipsis:{tooltip:!0},rowSpan:e=>e.row},{title:"链接",key:"url",render:e=>g("a",{class:"news-url",href:e.url,target:"_blank"},[e.url])},{title:"链接选择器",key:"selector",width:200},{title:"开启爬虫",key:"crawler",width:100,render:e=>g(k,{value:e.state,size:"small",loading:e.loading,"onUpdate:value":()=>i(e)})}],c=t([]);return f((async()=>{const t=await async function(){return e.get("/site/get/info")}();t&&(t.forEach((e=>{const t=e.list;t.forEach((a=>{var l;c.value.push({key:a._id,name:e.name,defaultSelector:e.defaultListSelector,url:a.url,selector:null!=(l=a.selector)?l:"默认选择器",state:a.state,loading:!1,row:t.length})}))})),s())})),(e,t)=>{const a=V;return n(),o(a,{loading:r(l),columns:u,data:r(c)},null,8,["loading","data"])}}}),E=a({__name:"index",setup:e=>(e,t)=>(n(),h("div",null,[i(r(j)),i(r(C)),i(r(B))]))});export{E as default};
